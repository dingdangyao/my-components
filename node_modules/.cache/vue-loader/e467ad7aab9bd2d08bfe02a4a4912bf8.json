{"remainingRequest":"C:\\Users\\10674\\Documents\\mp\\vue\\my-components\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\10674\\Documents\\mp\\vue\\my-components\\packages\\components\\Magnifier\\Magnifier.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\10674\\Documents\\mp\\vue\\my-components\\packages\\components\\Magnifier\\Magnifier.vue","mtime":1588426048854},{"path":"C:\\Users\\10674\\Documents\\mp\\vue\\my-components\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\10674\\Documents\\mp\\vue\\my-components\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAibWFnbmlmaWVyIiwKICBwcm9wczogewogICAgYm94U2l6ZTogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDUwMAogICAgfSwKICAgIG1pbkltZ1VybDogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQ6ICIiCiAgICB9LAogICAgbWF4SW1nVXJsOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogIiIKICAgIH0sCiAgICBhdXRvUmV2ZXJzZTogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0OiB0cnVlCiAgICB9LAogICAgZGlyZWN0aW9uOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogInJpZ2h0IgogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzU2hvdzogZmFsc2UsCiAgICAgIG1heEltZ1dpZHRoOiAiIiwKICAgICAgbWF4SW1nSGVpZ2h0OiAiIgogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIHNldE1hc2tTaXplKGUpIHsKICAgICAgdGhpcy5pc0xvYWQgPSB0cnVlOwogICAgICB0aGlzLm1heEltZ1dpZHRoID0gZS50YXJnZXQud2lkdGg7CiAgICAgIHRoaXMubWF4SW1nSGVpZ2h0ID0gZS50YXJnZXQuaGVpZ2h0OwogICAgICB0aGlzLiRyZWZzWyJpbWciXS53aWR0aCA9IGUudGFyZ2V0LndpZHRoOwogICAgICB0aGlzLiRyZWZzWyJpbWciXS5oZWlnaHQgPSBlLnRhcmdldC5oZWlnaHQ7CiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICB0aGlzLmluaXREb20oKTsKICAgICAgfSk7CiAgICB9LAogICAgaW5pdERvbSgpIHsKICAgICAgdGhpcy53cmFwID0gdGhpcy4kcmVmc1sid3JhcCJdOwogICAgICB0aGlzLm1heEJveCA9IHRoaXMuJHJlZnNbIm1heEJveCJdOwogICAgICB0aGlzLm1hc2sgPSB0aGlzLiRyZWZzWyJtYXNrIl07CiAgICAgIHRoaXMubWF4SW1nID0gdGhpcy4kcmVmc1siaW1nIl07CiAgICAgIHRoaXMuc21hbGwgPSB0aGlzLiRyZWZzWyJzbWFsbCJdOwogICAgICB0aGlzLnNtYWxsV2lkdGggPSB0aGlzLmdldERvbUF0dHIodGhpcy5zbWFsbCwgIndpZHRoIik7CiAgICAgIHRoaXMuc21hbGxIZWlnaHQgPSB0aGlzLmdldERvbUF0dHIodGhpcy5zbWFsbCwgImhlaWdodCIpOwogICAgICB0aGlzLm1heEJveC5zdHlsZS53aWR0aCA9IHRoaXMuYm94U2l6ZSArICJweCI7CiAgICAgIHRoaXMubWF4Qm94LnN0eWxlLmhlaWdodCA9IHRoaXMuYm94U2l6ZSArICJweCI7CiAgICB9LAogICAgZ2V0RG9tQXR0cihlbCwgYXR0cikgewogICAgICByZXR1cm4gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShlbClbYXR0cl0uc2xpY2UoMCwgLTIpKTsKICAgIH0sCiAgICBvbk1vdXNlZW50ZXIoKSB7CiAgICAgIHRoaXMuaXNTaG93ID0gdHJ1ZTsKICAgIH0sCiAgICBvbk1vdXNlbGVhdmUoKSB7CiAgICAgIHRoaXMuaXNTaG93ID0gZmFsc2U7CiAgICB9LAogICAgb25Nb3VzZW1vdmUoZSkgewogICAgICBpZiAoIXRoaXMud3JhcCB8fCAhdGhpcy5pc0xvYWQpIHJldHVybjsKCiAgICAgIGNvbnN0IG1hc2sgPSB0aGlzLiRyZWZzWyJtYXNrIl07CiAgICAgIGNvbnN0IG1heEltZ1dpZHRoID0gdGhpcy4kcmVmc1siaW1nIl0ud2lkdGg7CiAgICAgIGNvbnN0IG1pbkJveFdpZHRoID0gdGhpcy5zbWFsbFdpZHRoOwogICAgICBtYXNrLnN0eWxlLndpZHRoID0gbWluQm94V2lkdGggKiAobWluQm94V2lkdGggLyBtYXhJbWdXaWR0aCkgKyAicHgiOwogICAgICBtYXNrLnN0eWxlLmhlaWdodCA9IG1pbkJveFdpZHRoICogKG1pbkJveFdpZHRoIC8gbWF4SW1nV2lkdGgpICsgInB4IjsKCiAgICAgIGNvbnN0IGxlZnRQb3NpdGlvbiA9IHRoaXMud3JhcC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0OwogICAgICBjb25zdCB0b3BQb3NpdGlvbiA9IHRoaXMud3JhcC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3A7CiAgICAgIGNvbnN0IHBhZGRpbmdMZWZ0ID0gdGhpcy5nZXREb21BdHRyKHRoaXMud3JhcCwgInBhZGRpbmctbGVmdCIpOwogICAgICBjb25zdCBwYWRkZGluZ1RvcCA9IHRoaXMuZ2V0RG9tQXR0cih0aGlzLndyYXAsICJwYWRkaW5nLXRvcCIpOwoKICAgICAgbGV0IGxlZnQgPSBlLmNsaWVudFggLSBsZWZ0UG9zaXRpb24gLSB0aGlzLm1hc2sub2Zmc2V0V2lkdGggLyAyOwogICAgICBsZXQgdG9wID0gZS5jbGllbnRZIC0gdG9wUG9zaXRpb24gLSB0aGlzLm1hc2sub2Zmc2V0SGVpZ2h0IC8gMjsKCiAgICAgIGNvbnN0IG1heEJveFJpZ2h0UG9zID0KICAgICAgICBsZWZ0UG9zaXRpb24gKwogICAgICAgIHRoaXMubWF4Qm94LmNsaWVudExlZnQgKwogICAgICAgIHRoaXMuc21hbGwuY2xpZW50TGVmdCArCiAgICAgICAgdGhpcy53cmFwLmNsaWVudExlZnQgKwogICAgICAgIHBhZGRpbmdMZWZ0ICsKICAgICAgICB0aGlzLnNtYWxsLmNsaWVudFdpZHRoOwoKICAgICAgY29uc3QgbWF4Qm94TGVmdFBvcyA9CiAgICAgICAgbGVmdFBvc2l0aW9uICsKICAgICAgICB0aGlzLndyYXAuY2xpZW50TGVmdCArCiAgICAgICAgcGFkZGluZ0xlZnQgLQogICAgICAgIHRoaXMuc21hbGwuY2xpZW50TGVmdCAqIDIgLQogICAgICAgIHRoaXMuc21hbGwuY2xpZW50V2lkdGg7CgogICAgICBsZXQgbWF4Qm94UG9zID0gLTE7CgogICAgICBpZiAodGhpcy5hdXRvUmV2ZXJzZSkgewogICAgICAgIGNvbnN0IGlzTWF4Qm94RXhjZWVkV2luZG93ID0KICAgICAgICAgIG1heEJveFJpZ2h0UG9zICsgdGhpcy5nZXREb21BdHRyKHRoaXMubWF4Qm94LCAid2lkdGgiKSA+CiAgICAgICAgICB3aW5kb3cuaW5uZXJXaWR0aDsKICAgICAgICBtYXhCb3hQb3MgPSBpc01heEJveEV4Y2VlZFdpbmRvdyA/IG1heEJveExlZnRQb3MgOiBtYXhCb3hSaWdodFBvczsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhpcy5kaXJlY3Rpb24gPT09ICJyaWdodCIpIHsKICAgICAgICAgIG1heEJveFBvcyA9IG1heEJveFJpZ2h0UG9zOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy5kaXJlY3Rpb24gPT09ICJsZWZ0IikgewogICAgICAgICAgbWF4Qm94UG9zID0gbWF4Qm94TGVmdFBvczsKICAgICAgICB9CiAgICAgIH0KICAgICAgdGhpcy5tYXhCb3guc3R5bGUubGVmdCA9IG1heEJveFBvcyArICJweCI7CgogICAgICB0aGlzLm1heEJveC5zdHlsZS50b3AgPQogICAgICAgIHRvcFBvc2l0aW9uICsKICAgICAgICB0aGlzLndyYXAuY2xpZW50VG9wIC0KICAgICAgICB0aGlzLm1heEJveC5jbGllbnRUb3AgKwogICAgICAgIHBhZGRkaW5nVG9wICsKICAgICAgICB0aGlzLnNtYWxsLmNsaWVudFRvcCArCiAgICAgICAgInB4IjsKCiAgICAgIGlmIChsZWZ0IDwgcGFkZGluZ0xlZnQpIHsKICAgICAgICBsZWZ0ID0gcGFkZGluZ0xlZnQ7CiAgICAgIH0gZWxzZSBpZiAoCiAgICAgICAgbGVmdCA+CiAgICAgICAgdGhpcy5zbWFsbC5vZmZzZXRXaWR0aCAtIHRoaXMubWFzay5vZmZzZXRXaWR0aCArIHBhZGRpbmdMZWZ0CiAgICAgICkgewogICAgICAgIGxlZnQgPSB0aGlzLnNtYWxsLm9mZnNldFdpZHRoIC0gdGhpcy5tYXNrLm9mZnNldFdpZHRoICsgcGFkZGluZ0xlZnQ7CiAgICAgIH0KCiAgICAgIGlmICh0b3AgPCBwYWRkZGluZ1RvcCkgewogICAgICAgIHRvcCA9IHBhZGRkaW5nVG9wOwogICAgICB9IGVsc2UgaWYgKAogICAgICAgIHRvcCA+CiAgICAgICAgdGhpcy5zbWFsbC5vZmZzZXRIZWlnaHQgLSB0aGlzLm1hc2sub2Zmc2V0SGVpZ2h0ICsgcGFkZGRpbmdUb3AKICAgICAgKSB7CiAgICAgICAgdG9wID0gdGhpcy5zbWFsbC5vZmZzZXRIZWlnaHQgLSB0aGlzLm1hc2sub2Zmc2V0SGVpZ2h0ICsgcGFkZGRpbmdUb3A7CiAgICAgIH0KCiAgICAgIHRoaXMubWFzay5zdHlsZS5sZWZ0ID0gbGVmdCArICJweCI7CiAgICAgIHRoaXMubWFzay5zdHlsZS50b3AgPSB0b3AgKyAicHgiOwogICAgICBjb25zdCBwWCA9CiAgICAgICAgKGxlZnQgLSBwYWRkaW5nTGVmdCkgLyAodGhpcy5zbWFsbFdpZHRoIC0gdGhpcy5tYXNrLm9mZnNldFdpZHRoKTsKICAgICAgY29uc3QgcFkgPQogICAgICAgICh0b3AgLSBwYWRkZGluZ1RvcCkgLyAodGhpcy5zbWFsbEhlaWdodCAtIHRoaXMubWFzay5vZmZzZXRIZWlnaHQpOwogICAgICB0aGlzLm1heEltZy5zdHlsZS5sZWZ0ID0KICAgICAgICAtcFggKiAodGhpcy5tYXhJbWcud2lkdGggLSB0aGlzLm1heEJveC5vZmZzZXRXaWR0aCkgKyAicHgiOwogICAgICB0aGlzLm1heEltZy5zdHlsZS50b3AgPQogICAgICAgIC1wWSAqICh0aGlzLm1heEltZy5oZWlnaHQgLSB0aGlzLm1heEJveC5vZmZzZXRIZWlnaHQpICsgInB4IjsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["Magnifier.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Magnifier.vue","sourceRoot":"packages/components/Magnifier","sourcesContent":["<template>\n  <div>\n    <div class=\"magnifier-wrap\" ref=\"wrap\">\n      <div\n        class=\"small-wrap\"\n        ref=\"small\"\n        @mouseleave=\"onMouseleave\"\n        @mousemove=\"onMousemove\"\n        @mouseenter=\"onMouseenter\"\n      >\n        <div class=\"mask-wrap\" ref=\"mask\" v-show=\"isShow\"></div>\n        <img :src=\"minImgUrl\" :width=\"boxSize\" :height=\"boxSize\" />\n      </div>\n      <div class=\"max-wrap\" ref=\"maxBox\" v-show=\"isShow\">\n        <img\n          :src=\"maxImgUrl\"\n          :style=\"{ width: maxImgWidth + 'px', height: maxImgHeight + 'px' }\"\n          class=\"img\"\n          ref=\"img\"\n          @load=\"setMaskSize\"\n        />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"magnifier\",\n  props: {\n    boxSize: {\n      type: Number,\n      default: 500\n    },\n    minImgUrl: {\n      type: String,\n      default: \"\"\n    },\n    maxImgUrl: {\n      type: String,\n      default: \"\"\n    },\n    autoReverse: {\n      type: Boolean,\n      default: true\n    },\n    direction: {\n      type: String,\n      default: \"right\"\n    }\n  },\n  data() {\n    return {\n      isShow: false,\n      maxImgWidth: \"\",\n      maxImgHeight: \"\"\n    };\n  },\n  methods: {\n    setMaskSize(e) {\n      this.isLoad = true;\n      this.maxImgWidth = e.target.width;\n      this.maxImgHeight = e.target.height;\n      this.$refs[\"img\"].width = e.target.width;\n      this.$refs[\"img\"].height = e.target.height;\n      this.$nextTick(() => {\n        this.initDom();\n      });\n    },\n    initDom() {\n      this.wrap = this.$refs[\"wrap\"];\n      this.maxBox = this.$refs[\"maxBox\"];\n      this.mask = this.$refs[\"mask\"];\n      this.maxImg = this.$refs[\"img\"];\n      this.small = this.$refs[\"small\"];\n      this.smallWidth = this.getDomAttr(this.small, \"width\");\n      this.smallHeight = this.getDomAttr(this.small, \"height\");\n      this.maxBox.style.width = this.boxSize + \"px\";\n      this.maxBox.style.height = this.boxSize + \"px\";\n    },\n    getDomAttr(el, attr) {\n      return parseInt(getComputedStyle(el)[attr].slice(0, -2));\n    },\n    onMouseenter() {\n      this.isShow = true;\n    },\n    onMouseleave() {\n      this.isShow = false;\n    },\n    onMousemove(e) {\n      if (!this.wrap || !this.isLoad) return;\n\n      const mask = this.$refs[\"mask\"];\n      const maxImgWidth = this.$refs[\"img\"].width;\n      const minBoxWidth = this.smallWidth;\n      mask.style.width = minBoxWidth * (minBoxWidth / maxImgWidth) + \"px\";\n      mask.style.height = minBoxWidth * (minBoxWidth / maxImgWidth) + \"px\";\n\n      const leftPosition = this.wrap.getBoundingClientRect().left;\n      const topPosition = this.wrap.getBoundingClientRect().top;\n      const paddingLeft = this.getDomAttr(this.wrap, \"padding-left\");\n      const padddingTop = this.getDomAttr(this.wrap, \"padding-top\");\n\n      let left = e.clientX - leftPosition - this.mask.offsetWidth / 2;\n      let top = e.clientY - topPosition - this.mask.offsetHeight / 2;\n\n      const maxBoxRightPos =\n        leftPosition +\n        this.maxBox.clientLeft +\n        this.small.clientLeft +\n        this.wrap.clientLeft +\n        paddingLeft +\n        this.small.clientWidth;\n\n      const maxBoxLeftPos =\n        leftPosition +\n        this.wrap.clientLeft +\n        paddingLeft -\n        this.small.clientLeft * 2 -\n        this.small.clientWidth;\n\n      let maxBoxPos = -1;\n\n      if (this.autoReverse) {\n        const isMaxBoxExceedWindow =\n          maxBoxRightPos + this.getDomAttr(this.maxBox, \"width\") >\n          window.innerWidth;\n        maxBoxPos = isMaxBoxExceedWindow ? maxBoxLeftPos : maxBoxRightPos;\n      } else {\n        if (this.direction === \"right\") {\n          maxBoxPos = maxBoxRightPos;\n        } else if (this.direction === \"left\") {\n          maxBoxPos = maxBoxLeftPos;\n        }\n      }\n      this.maxBox.style.left = maxBoxPos + \"px\";\n\n      this.maxBox.style.top =\n        topPosition +\n        this.wrap.clientTop -\n        this.maxBox.clientTop +\n        padddingTop +\n        this.small.clientTop +\n        \"px\";\n\n      if (left < paddingLeft) {\n        left = paddingLeft;\n      } else if (\n        left >\n        this.small.offsetWidth - this.mask.offsetWidth + paddingLeft\n      ) {\n        left = this.small.offsetWidth - this.mask.offsetWidth + paddingLeft;\n      }\n\n      if (top < padddingTop) {\n        top = padddingTop;\n      } else if (\n        top >\n        this.small.offsetHeight - this.mask.offsetHeight + padddingTop\n      ) {\n        top = this.small.offsetHeight - this.mask.offsetHeight + padddingTop;\n      }\n\n      this.mask.style.left = left + \"px\";\n      this.mask.style.top = top + \"px\";\n      const pX =\n        (left - paddingLeft) / (this.smallWidth - this.mask.offsetWidth);\n      const pY =\n        (top - padddingTop) / (this.smallHeight - this.mask.offsetHeight);\n      this.maxImg.style.left =\n        -pX * (this.maxImg.width - this.maxBox.offsetWidth) + \"px\";\n      this.maxImg.style.top =\n        -pY * (this.maxImg.height - this.maxBox.offsetHeight) + \"px\";\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.magnifier-wrap {\n  position: relative;\n  box-sizing: border-box;\n\n  .small-wrap {\n    display: inline-block;\n    z-index: 1;\n    border: 1px solid #ccc;\n    box-sizing: border-box;\n\n    .mask-wrap {\n      position: absolute;\n      cursor: move;\n      background: RGBA(255, 255, 255, 0.5);\n      z-index: 1;\n    }\n  }\n\n  .max-wrap {\n    position: fixed;\n    border: 1px solid #ccc;\n    overflow: hidden;\n    background: #fff;\n\n    .img {\n      position: absolute;\n    }\n  }\n}\n</style>\n"]}]}