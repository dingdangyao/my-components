{"remainingRequest":"C:\\Users\\10674\\Documents\\mp\\vue\\my-components\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\10674\\Documents\\mp\\vue\\my-components\\node_modules\\element-ui\\packages\\image\\src\\image-viewer.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\10674\\Documents\\mp\\vue\\my-components\\node_modules\\element-ui\\packages\\image\\src\\image-viewer.vue","mtime":499162500000},{"path":"C:\\Users\\10674\\Documents\\mp\\vue\\my-components\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\10674\\Documents\\mp\\vue\\my-components\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG9uLCBvZmYgfSBmcm9tICdlbGVtZW50LXVpL3NyYy91dGlscy9kb20nOwppbXBvcnQgeyByYWZUaHJvdHRsZSwgaXNGaXJlZm94IH0gZnJvbSAnZWxlbWVudC11aS9zcmMvdXRpbHMvdXRpbCc7Cgpjb25zdCBNb2RlID0gewogIENPTlRBSU46IHsKICAgIG5hbWU6ICdjb250YWluJywKICAgIGljb246ICdlbC1pY29uLWZ1bGwtc2NyZWVuJwogIH0sCiAgT1JJR0lOQUw6IHsKICAgIG5hbWU6ICdvcmlnaW5hbCcsCiAgICBpY29uOiAnZWwtaWNvbi1jLXNjYWxlLXRvLW9yaWdpbmFsJwogIH0KfTsKCmNvbnN0IG1vdXNld2hlZWxFdmVudE5hbWUgPSBpc0ZpcmVmb3goKSA/ICdET01Nb3VzZVNjcm9sbCcgOiAnbW91c2V3aGVlbCc7CgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2VsSW1hZ2VWaWV3ZXInLAoKICBwcm9wczogewogICAgdXJsTGlzdDogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdDogKCkgPT4gW10KICAgIH0sCiAgICB6SW5kZXg6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAyMDAwCiAgICB9LAogICAgb25Td2l0Y2g6IHsKICAgICAgdHlwZTogRnVuY3Rpb24sCiAgICAgIGRlZmF1bHQ6ICgpID0+IHt9CiAgICB9LAogICAgb25DbG9zZTogewogICAgICB0eXBlOiBGdW5jdGlvbiwKICAgICAgZGVmYXVsdDogKCkgPT4ge30KICAgIH0sCiAgICBpbml0aWFsSW5kZXg6IHsKICAgICAgdHlwZTogTnVtYmVyLAogICAgICBkZWZhdWx0OiAwCiAgICB9CiAgfSwKCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGluZGV4OiB0aGlzLmluaXRpYWxJbmRleCwKICAgICAgaXNTaG93OiBmYWxzZSwKICAgICAgaW5maW5pdGU6IHRydWUsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBtb2RlOiBNb2RlLkNPTlRBSU4sCiAgICAgIHRyYW5zZm9ybTogewogICAgICAgIHNjYWxlOiAxLAogICAgICAgIGRlZzogMCwKICAgICAgICBvZmZzZXRYOiAwLAogICAgICAgIG9mZnNldFk6IDAsCiAgICAgICAgZW5hYmxlVHJhbnNpdGlvbjogZmFsc2UKICAgICAgfQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICBpc1NpbmdsZSgpIHsKICAgICAgcmV0dXJuIHRoaXMudXJsTGlzdC5sZW5ndGggPD0gMTsKICAgIH0sCiAgICBpc0ZpcnN0KCkgewogICAgICByZXR1cm4gdGhpcy5pbmRleCA9PT0gMDsKICAgIH0sCiAgICBpc0xhc3QoKSB7CiAgICAgIHJldHVybiB0aGlzLmluZGV4ID09PSB0aGlzLnVybExpc3QubGVuZ3RoIC0gMTsKICAgIH0sCiAgICBjdXJyZW50SW1nKCkgewogICAgICByZXR1cm4gdGhpcy51cmxMaXN0W3RoaXMuaW5kZXhdOwogICAgfSwKICAgIGltZ1N0eWxlKCkgewogICAgICBjb25zdCB7IHNjYWxlLCBkZWcsIG9mZnNldFgsIG9mZnNldFksIGVuYWJsZVRyYW5zaXRpb24gfSA9IHRoaXMudHJhbnNmb3JtOwogICAgICBjb25zdCBzdHlsZSA9IHsKICAgICAgICB0cmFuc2Zvcm06IGBzY2FsZSgke3NjYWxlfSkgcm90YXRlKCR7ZGVnfWRlZylgLAogICAgICAgIHRyYW5zaXRpb246IGVuYWJsZVRyYW5zaXRpb24gPyAndHJhbnNmb3JtIC4zcycgOiAnJywKICAgICAgICAnbWFyZ2luLWxlZnQnOiBgJHtvZmZzZXRYfXB4YCwKICAgICAgICAnbWFyZ2luLXRvcCc6IGAke29mZnNldFl9cHhgCiAgICAgIH07CiAgICAgIGlmICh0aGlzLm1vZGUgPT09IE1vZGUuQ09OVEFJTikgewogICAgICAgIHN0eWxlLm1heFdpZHRoID0gc3R5bGUubWF4SGVpZ2h0ID0gJzEwMCUnOwogICAgICB9CiAgICAgIHJldHVybiBzdHlsZTsKICAgIH0KICB9LAogIHdhdGNoOiB7CiAgICBpbmRleDogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbih2YWwpIHsKICAgICAgICB0aGlzLnJlc2V0KCk7CiAgICAgICAgdGhpcy5vblN3aXRjaCh2YWwpOwogICAgICB9CiAgICB9LAogICAgY3VycmVudEltZyh2YWwpIHsKICAgICAgdGhpcy4kbmV4dFRpY2soXyA9PiB7CiAgICAgICAgY29uc3QgJGltZyA9IHRoaXMuJHJlZnMuaW1nWzBdOwogICAgICAgIGlmICghJGltZy5jb21wbGV0ZSkgewogICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgaGlkZSgpIHsKICAgICAgdGhpcy5kZXZpY2VTdXBwb3J0VW5pbnN0YWxsKCk7CiAgICAgIHRoaXMub25DbG9zZSgpOwogICAgfSwKICAgIGRldmljZVN1cHBvcnRJbnN0YWxsKCkgewogICAgICB0aGlzLl9rZXlEb3duSGFuZGxlciA9IHJhZlRocm90dGxlKGUgPT4gewogICAgICAgIGNvbnN0IGtleUNvZGUgPSBlLmtleUNvZGU7CiAgICAgICAgc3dpdGNoIChrZXlDb2RlKSB7CiAgICAgICAgICAvLyBFU0MKICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgIHRoaXMuaGlkZSgpOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIC8vIFNQQUNFCiAgICAgICAgICBjYXNlIDMyOgogICAgICAgICAgICB0aGlzLnRvZ2dsZU1vZGUoKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAvLyBMRUZUX0FSUk9XCiAgICAgICAgICBjYXNlIDM3OgogICAgICAgICAgICB0aGlzLnByZXYoKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAvLyBVUF9BUlJPVwogICAgICAgICAgY2FzZSAzODoKICAgICAgICAgICAgdGhpcy5oYW5kbGVBY3Rpb25zKCd6b29tSW4nKTsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAvLyBSSUdIVF9BUlJPVwogICAgICAgICAgY2FzZSAzOToKICAgICAgICAgICAgdGhpcy5uZXh0KCk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgLy8gRE9XTl9BUlJPVwogICAgICAgICAgY2FzZSA0MDoKICAgICAgICAgICAgdGhpcy5oYW5kbGVBY3Rpb25zKCd6b29tT3V0Jyk7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHRoaXMuX21vdXNlV2hlZWxIYW5kbGVyID0gcmFmVGhyb3R0bGUoZSA9PiB7CiAgICAgICAgY29uc3QgZGVsdGEgPSBlLndoZWVsRGVsdGEgPyBlLndoZWVsRGVsdGEgOiAtZS5kZXRhaWw7CiAgICAgICAgaWYgKGRlbHRhID4gMCkgewogICAgICAgICAgdGhpcy5oYW5kbGVBY3Rpb25zKCd6b29tSW4nLCB7CiAgICAgICAgICAgIHpvb21SYXRlOiAwLjAxNSwKICAgICAgICAgICAgZW5hYmxlVHJhbnNpdGlvbjogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmhhbmRsZUFjdGlvbnMoJ3pvb21PdXQnLCB7CiAgICAgICAgICAgIHpvb21SYXRlOiAwLjAxNSwKICAgICAgICAgICAgZW5hYmxlVHJhbnNpdGlvbjogZmFsc2UKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIG9uKGRvY3VtZW50LCAna2V5ZG93bicsIHRoaXMuX2tleURvd25IYW5kbGVyKTsKICAgICAgb24oZG9jdW1lbnQsIG1vdXNld2hlZWxFdmVudE5hbWUsIHRoaXMuX21vdXNlV2hlZWxIYW5kbGVyKTsKICAgIH0sCiAgICBkZXZpY2VTdXBwb3J0VW5pbnN0YWxsKCkgewogICAgICBvZmYoZG9jdW1lbnQsICdrZXlkb3duJywgdGhpcy5fa2V5RG93bkhhbmRsZXIpOwogICAgICBvZmYoZG9jdW1lbnQsIG1vdXNld2hlZWxFdmVudE5hbWUsIHRoaXMuX21vdXNlV2hlZWxIYW5kbGVyKTsKICAgICAgdGhpcy5fa2V5RG93bkhhbmRsZXIgPSBudWxsOwogICAgICB0aGlzLl9tb3VzZVdoZWVsSGFuZGxlciA9IG51bGw7CiAgICB9LAogICAgaGFuZGxlSW1nTG9hZChlKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgfSwKICAgIGhhbmRsZUltZ0Vycm9yKGUpIHsKICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2U7CiAgICAgIGUudGFyZ2V0LmFsdCA9ICfliqDovb3lpLHotKUnOwogICAgfSwKICAgIGhhbmRsZU1vdXNlRG93bihlKSB7CiAgICAgIGlmICh0aGlzLmxvYWRpbmcgfHwgZS5idXR0b24gIT09IDApIHJldHVybjsKCiAgICAgIGNvbnN0IHsgb2Zmc2V0WCwgb2Zmc2V0WSB9ID0gdGhpcy50cmFuc2Zvcm07CiAgICAgIGNvbnN0IHN0YXJ0WCA9IGUucGFnZVg7CiAgICAgIGNvbnN0IHN0YXJ0WSA9IGUucGFnZVk7CiAgICAgIHRoaXMuX2RyYWdIYW5kbGVyID0gcmFmVGhyb3R0bGUoZXYgPT4gewogICAgICAgIHRoaXMudHJhbnNmb3JtLm9mZnNldFggPSBvZmZzZXRYICsgZXYucGFnZVggLSBzdGFydFg7CiAgICAgICAgdGhpcy50cmFuc2Zvcm0ub2Zmc2V0WSA9IG9mZnNldFkgKyBldi5wYWdlWSAtIHN0YXJ0WTsKICAgICAgfSk7CiAgICAgIG9uKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdGhpcy5fZHJhZ0hhbmRsZXIpOwogICAgICBvbihkb2N1bWVudCwgJ21vdXNldXAnLCBldiA9PiB7CiAgICAgICAgb2ZmKGRvY3VtZW50LCAnbW91c2Vtb3ZlJywgdGhpcy5fZHJhZ0hhbmRsZXIpOwogICAgICB9KTsKCiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIH0sCiAgICByZXNldCgpIHsKICAgICAgdGhpcy50cmFuc2Zvcm0gPSB7CiAgICAgICAgc2NhbGU6IDEsCiAgICAgICAgZGVnOiAwLAogICAgICAgIG9mZnNldFg6IDAsCiAgICAgICAgb2Zmc2V0WTogMCwKICAgICAgICBlbmFibGVUcmFuc2l0aW9uOiBmYWxzZQogICAgICB9OwogICAgfSwKICAgIHRvZ2dsZU1vZGUoKSB7CiAgICAgIGlmICh0aGlzLmxvYWRpbmcpIHJldHVybjsKCiAgICAgIGNvbnN0IG1vZGVOYW1lcyA9IE9iamVjdC5rZXlzKE1vZGUpOwogICAgICBjb25zdCBtb2RlVmFsdWVzID0gT2JqZWN0LnZhbHVlcyhNb2RlKTsKICAgICAgY29uc3QgaW5kZXggPSBtb2RlVmFsdWVzLmluZGV4T2YodGhpcy5tb2RlKTsKICAgICAgY29uc3QgbmV4dEluZGV4ID0gKGluZGV4ICsgMSkgJSBtb2RlTmFtZXMubGVuZ3RoOwogICAgICB0aGlzLm1vZGUgPSBNb2RlW21vZGVOYW1lc1tuZXh0SW5kZXhdXTsKICAgICAgdGhpcy5yZXNldCgpOwogICAgfSwKICAgIHByZXYoKSB7CiAgICAgIGlmICh0aGlzLmlzRmlyc3QgJiYgIXRoaXMuaW5maW5pdGUpIHJldHVybjsKICAgICAgY29uc3QgbGVuID0gdGhpcy51cmxMaXN0Lmxlbmd0aDsKICAgICAgdGhpcy5pbmRleCA9ICh0aGlzLmluZGV4IC0gMSArIGxlbikgJSBsZW47CiAgICB9LAogICAgbmV4dCgpIHsKICAgICAgaWYgKHRoaXMuaXNMYXN0ICYmICF0aGlzLmluZmluaXRlKSByZXR1cm47CiAgICAgIGNvbnN0IGxlbiA9IHRoaXMudXJsTGlzdC5sZW5ndGg7CiAgICAgIHRoaXMuaW5kZXggPSAodGhpcy5pbmRleCArIDEpICUgbGVuOwogICAgfSwKICAgIGhhbmRsZUFjdGlvbnMoYWN0aW9uLCBvcHRpb25zID0ge30pIHsKICAgICAgaWYgKHRoaXMubG9hZGluZykgcmV0dXJuOwogICAgICBjb25zdCB7IHpvb21SYXRlLCByb3RhdGVEZWcsIGVuYWJsZVRyYW5zaXRpb24gfSA9IHsKICAgICAgICB6b29tUmF0ZTogMC4yLAogICAgICAgIHJvdGF0ZURlZzogOTAsCiAgICAgICAgZW5hYmxlVHJhbnNpdGlvbjogdHJ1ZSwKICAgICAgICAuLi5vcHRpb25zCiAgICAgIH07CiAgICAgIGNvbnN0IHsgdHJhbnNmb3JtIH0gPSB0aGlzOwogICAgICBzd2l0Y2ggKGFjdGlvbikgewogICAgICAgIGNhc2UgJ3pvb21PdXQnOgogICAgICAgICAgaWYgKHRyYW5zZm9ybS5zY2FsZSA+IDAuMikgewogICAgICAgICAgICB0cmFuc2Zvcm0uc2NhbGUgPSBwYXJzZUZsb2F0KCh0cmFuc2Zvcm0uc2NhbGUgLSB6b29tUmF0ZSkudG9GaXhlZCgzKSk7CiAgICAgICAgICB9CiAgICAgICAgICBicmVhazsKICAgICAgICBjYXNlICd6b29tSW4nOgogICAgICAgICAgdHJhbnNmb3JtLnNjYWxlID0gcGFyc2VGbG9hdCgodHJhbnNmb3JtLnNjYWxlICsgem9vbVJhdGUpLnRvRml4ZWQoMykpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnY2xvY2VsaXNlJzoKICAgICAgICAgIHRyYW5zZm9ybS5kZWcgKz0gcm90YXRlRGVnOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAnYW50aWNsb2NlbGlzZSc6CiAgICAgICAgICB0cmFuc2Zvcm0uZGVnIC09IHJvdGF0ZURlZzsKICAgICAgICAgIGJyZWFrOwogICAgICB9CiAgICAgIHRyYW5zZm9ybS5lbmFibGVUcmFuc2l0aW9uID0gZW5hYmxlVHJhbnNpdGlvbjsKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmRldmljZVN1cHBvcnRJbnN0YWxsKCk7CiAgICAvLyBhZGQgdGFiaW5kZXggdGhlbiB3cmFwcGVyIGNhbiBiZSBmb2N1c2FibGUgdmlhIEphdmFzY3JpcHQKICAgIC8vIGZvY3VzIHdyYXBwZXIgc28gYXJyb3cga2V5IGNhbid0IGNhdXNlIGlubmVyIHNjcm9sbCBiZWhhdmlvciB1bmRlcm5lYXRoCiAgICB0aGlzLiRyZWZzWydlbC1pbWFnZS12aWV3ZXJfX3dyYXBwZXInXS5mb2N1cygpOwogIH0KfTsK"},{"version":3,"sources":["image-viewer.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"image-viewer.vue","sourceRoot":"node_modules/element-ui/packages/image/src","sourcesContent":["<template>\n  <transition name=\"viewer-fade\">\n    <div tabindex=\"-1\" ref=\"el-image-viewer__wrapper\" class=\"el-image-viewer__wrapper\" :style=\"{ 'z-index': zIndex }\">\n      <div class=\"el-image-viewer__mask\"></div>\n      <!-- CLOSE -->\n      <span class=\"el-image-viewer__btn el-image-viewer__close\" @click=\"hide\">\n        <i class=\"el-icon-circle-close\"></i>\n      </span>\n      <!-- ARROW -->\n      <template v-if=\"!isSingle\">\n        <span\n          class=\"el-image-viewer__btn el-image-viewer__prev\"\n          :class=\"{ 'is-disabled': !infinite && isFirst }\"\n          @click=\"prev\">\n          <i class=\"el-icon-arrow-left\"/>\n        </span>\n        <span\n          class=\"el-image-viewer__btn el-image-viewer__next\"\n          :class=\"{ 'is-disabled': !infinite && isLast }\"\n          @click=\"next\">\n          <i class=\"el-icon-arrow-right\"/>\n        </span>\n      </template>\n      <!-- ACTIONS -->\n      <div class=\"el-image-viewer__btn el-image-viewer__actions\">\n        <div class=\"el-image-viewer__actions__inner\">\n          <i class=\"el-icon-zoom-out\" @click=\"handleActions('zoomOut')\"></i>\n          <i class=\"el-icon-zoom-in\" @click=\"handleActions('zoomIn')\"></i>\n          <i class=\"el-image-viewer__actions__divider\"></i>\n          <i :class=\"mode.icon\" @click=\"toggleMode\"></i>\n          <i class=\"el-image-viewer__actions__divider\"></i>\n          <i class=\"el-icon-refresh-left\" @click=\"handleActions('anticlocelise')\"></i>\n          <i class=\"el-icon-refresh-right\" @click=\"handleActions('clocelise')\"></i>\n        </div>\n      </div>\n      <!-- CANVAS -->\n      <div class=\"el-image-viewer__canvas\">\n        <img\n          v-for=\"(url, i) in urlList\"\n          v-if=\"i === index\"\n          ref=\"img\"\n          class=\"el-image-viewer__img\"\n          :key=\"url\"\n          :src=\"currentImg\"\n          :style=\"imgStyle\"\n          @load=\"handleImgLoad\"\n          @error=\"handleImgError\"\n          @mousedown=\"handleMouseDown\">\n      </div>\n    </div>\n  </transition>\n</template>\n\n<script>\nimport { on, off } from 'element-ui/src/utils/dom';\nimport { rafThrottle, isFirefox } from 'element-ui/src/utils/util';\n\nconst Mode = {\n  CONTAIN: {\n    name: 'contain',\n    icon: 'el-icon-full-screen'\n  },\n  ORIGINAL: {\n    name: 'original',\n    icon: 'el-icon-c-scale-to-original'\n  }\n};\n\nconst mousewheelEventName = isFirefox() ? 'DOMMouseScroll' : 'mousewheel';\n\nexport default {\n  name: 'elImageViewer',\n\n  props: {\n    urlList: {\n      type: Array,\n      default: () => []\n    },\n    zIndex: {\n      type: Number,\n      default: 2000\n    },\n    onSwitch: {\n      type: Function,\n      default: () => {}\n    },\n    onClose: {\n      type: Function,\n      default: () => {}\n    },\n    initialIndex: {\n      type: Number,\n      default: 0\n    }\n  },\n\n  data() {\n    return {\n      index: this.initialIndex,\n      isShow: false,\n      infinite: true,\n      loading: false,\n      mode: Mode.CONTAIN,\n      transform: {\n        scale: 1,\n        deg: 0,\n        offsetX: 0,\n        offsetY: 0,\n        enableTransition: false\n      }\n    };\n  },\n  computed: {\n    isSingle() {\n      return this.urlList.length <= 1;\n    },\n    isFirst() {\n      return this.index === 0;\n    },\n    isLast() {\n      return this.index === this.urlList.length - 1;\n    },\n    currentImg() {\n      return this.urlList[this.index];\n    },\n    imgStyle() {\n      const { scale, deg, offsetX, offsetY, enableTransition } = this.transform;\n      const style = {\n        transform: `scale(${scale}) rotate(${deg}deg)`,\n        transition: enableTransition ? 'transform .3s' : '',\n        'margin-left': `${offsetX}px`,\n        'margin-top': `${offsetY}px`\n      };\n      if (this.mode === Mode.CONTAIN) {\n        style.maxWidth = style.maxHeight = '100%';\n      }\n      return style;\n    }\n  },\n  watch: {\n    index: {\n      handler: function(val) {\n        this.reset();\n        this.onSwitch(val);\n      }\n    },\n    currentImg(val) {\n      this.$nextTick(_ => {\n        const $img = this.$refs.img[0];\n        if (!$img.complete) {\n          this.loading = true;\n        }\n      });\n    }\n  },\n  methods: {\n    hide() {\n      this.deviceSupportUninstall();\n      this.onClose();\n    },\n    deviceSupportInstall() {\n      this._keyDownHandler = rafThrottle(e => {\n        const keyCode = e.keyCode;\n        switch (keyCode) {\n          // ESC\n          case 27:\n            this.hide();\n            break;\n          // SPACE\n          case 32:\n            this.toggleMode();\n            break;\n          // LEFT_ARROW\n          case 37:\n            this.prev();\n            break;\n          // UP_ARROW\n          case 38:\n            this.handleActions('zoomIn');\n            break;\n          // RIGHT_ARROW\n          case 39:\n            this.next();\n            break;\n          // DOWN_ARROW\n          case 40:\n            this.handleActions('zoomOut');\n            break;\n        }\n      });\n      this._mouseWheelHandler = rafThrottle(e => {\n        const delta = e.wheelDelta ? e.wheelDelta : -e.detail;\n        if (delta > 0) {\n          this.handleActions('zoomIn', {\n            zoomRate: 0.015,\n            enableTransition: false\n          });\n        } else {\n          this.handleActions('zoomOut', {\n            zoomRate: 0.015,\n            enableTransition: false\n          });\n        }\n      });\n      on(document, 'keydown', this._keyDownHandler);\n      on(document, mousewheelEventName, this._mouseWheelHandler);\n    },\n    deviceSupportUninstall() {\n      off(document, 'keydown', this._keyDownHandler);\n      off(document, mousewheelEventName, this._mouseWheelHandler);\n      this._keyDownHandler = null;\n      this._mouseWheelHandler = null;\n    },\n    handleImgLoad(e) {\n      this.loading = false;\n    },\n    handleImgError(e) {\n      this.loading = false;\n      e.target.alt = '加载失败';\n    },\n    handleMouseDown(e) {\n      if (this.loading || e.button !== 0) return;\n\n      const { offsetX, offsetY } = this.transform;\n      const startX = e.pageX;\n      const startY = e.pageY;\n      this._dragHandler = rafThrottle(ev => {\n        this.transform.offsetX = offsetX + ev.pageX - startX;\n        this.transform.offsetY = offsetY + ev.pageY - startY;\n      });\n      on(document, 'mousemove', this._dragHandler);\n      on(document, 'mouseup', ev => {\n        off(document, 'mousemove', this._dragHandler);\n      });\n\n      e.preventDefault();\n    },\n    reset() {\n      this.transform = {\n        scale: 1,\n        deg: 0,\n        offsetX: 0,\n        offsetY: 0,\n        enableTransition: false\n      };\n    },\n    toggleMode() {\n      if (this.loading) return;\n\n      const modeNames = Object.keys(Mode);\n      const modeValues = Object.values(Mode);\n      const index = modeValues.indexOf(this.mode);\n      const nextIndex = (index + 1) % modeNames.length;\n      this.mode = Mode[modeNames[nextIndex]];\n      this.reset();\n    },\n    prev() {\n      if (this.isFirst && !this.infinite) return;\n      const len = this.urlList.length;\n      this.index = (this.index - 1 + len) % len;\n    },\n    next() {\n      if (this.isLast && !this.infinite) return;\n      const len = this.urlList.length;\n      this.index = (this.index + 1) % len;\n    },\n    handleActions(action, options = {}) {\n      if (this.loading) return;\n      const { zoomRate, rotateDeg, enableTransition } = {\n        zoomRate: 0.2,\n        rotateDeg: 90,\n        enableTransition: true,\n        ...options\n      };\n      const { transform } = this;\n      switch (action) {\n        case 'zoomOut':\n          if (transform.scale > 0.2) {\n            transform.scale = parseFloat((transform.scale - zoomRate).toFixed(3));\n          }\n          break;\n        case 'zoomIn':\n          transform.scale = parseFloat((transform.scale + zoomRate).toFixed(3));\n          break;\n        case 'clocelise':\n          transform.deg += rotateDeg;\n          break;\n        case 'anticlocelise':\n          transform.deg -= rotateDeg;\n          break;\n      }\n      transform.enableTransition = enableTransition;\n    }\n  },\n  mounted() {\n    this.deviceSupportInstall();\n    // add tabindex then wrapper can be focusable via Javascript\n    // focus wrapper so arrow key can't cause inner scroll behavior underneath\n    this.$refs['el-image-viewer__wrapper'].focus();\n  }\n};\n</script>\n"]}]}